# ==============================================================================
# ==============================================================================
# Runs a langevin Simulation of an Ideal Gas
# Written By: Amro Dodin (Geissler Group - UC Berkeley & LBL)
# NOTE: Langevin damping constant must be passed in as command line -var gamma
# ==============================================================================
# ==============================================================================

# ==============================================================================
# Set Simulation Parameters
# ==============================================================================

# Random Seeds for Atom Initialization
variable SEED1 equal 256345 # Atom Positions
variable SEED2 equal 562538 # Atom Velocities
variable SEED3 equal 327642 # Langevin

# Timestep & Simulation Length
variable dt equal 1.0         # Timestep in fs
variable n_step equal 10000   # Number of Timesteps

# Temperatures
variable T1 equal 300

# ==============================================================================
# Set Up Simulation Box
# ==============================================================================

# Set Log File
log log.langevin.${gamma}

# Set Units, & Boundary Conditions
units real
dimension 3
boundary p p p

# Set Atom Specification Style (what data is stored per atom)
atom_style atomic

# Create 200 A x 200 A x 200 A Simulation Box centered at 0
region box block -100 100 -100 100 -100 100
create_box 1 box

# ==============================================================================
# Define Force Field (No Interactions)
# ==============================================================================

# Use Mass of Helium (4 a.u.)
mass 1 4.0

# Set Pair Coefficients (Zero)
pair_style zero 0
pair_coeff * *

# ==============================================================================
# Initialize System
# ==============================================================================

# Create Atoms (Molar Volume = 24.63 L/mol = 4.09e4 A^3/atom)
create_atoms 1 random 200 ${SEED1} box

# Randomly Initialize Velocities at 300 K
velocity all create ${T1} ${SEED2}

# ==============================================================================
# Set Up Propagation
# ==============================================================================

# Set Timestep
timestep ${dt}

# Initialize NVE Propagator
fix lang all langevin ${T1} ${T1} ${gamma} ${SEED3}
fix 1 all nve

# ==============================================================================
# Set Up Output
# ==============================================================================

# Output Thermodynamic Data every 100 Steps
thermo 100

# Output Atomistic Data every 100 Steps
dump 1 all atom 100 ideal-gas-langevin.${gamma}.lammpstrj

# ==============================================================================
# Run Simulation
# ==============================================================================
run ${n_step}
